{% extends "layout.html" %}

{% block head %}
    <script src="/static/js/all_tests.js"></script>
{% endblock %}

{% block content %}

    domain:
    <input id="domain-val" type="text" value="{{ cur_domain }}" data-provide="typeahead" data-source='[{% for domain in domains %}"{{ domain }}",{% endfor %}"lun.ua"]' />

    <table class="table">
        <thead>
            <tr>
                <th>id</th>
                <th>last result</th>
                <th>last run</th>
                <th>fail screenshots</th>
                <th>status</th>
                <th>log</th>
                <th><input id="test-all" type="button" class="btn" value="run all"/></th>
            </tr>
        </thead>
        <tbody>
            {% for test_id, test_data in tests.items %}
                <tr test_id="{{ test_id }}">
                    <td>
                        <a href="#" rel="popover">{{ test_id }}</a>
                        <div class="doc" style="display:none">
                            {{ test_data.doc }}
                        </div>
                    </td>
                    <td>
                        {% if 'ACCEPTED' in test_data.last_result %}
                            <span class="label label-success">{{ test_data.last_result }}</span>
                        {% else %}
                            <span class="label label-important">{{ test_data.last_result }}</span>
                        {% endif %}
                    </td>
                    <td>
                        {{ test_data.last_run }}
                    </td>
                    <td>
                        {% for sc in test_data.screenshots %}
                            <a href="{{ sc }}">#</a>
                        {% endfor %}
                    </td>
                    <td>
                        {% if test_data.status == 0 %}
                            <span class="label label-info">ready</span>
                        {% else %}
                            <span class="label label-warning">running pid={{ test_data.status }}</span>
                        {% endif %}
                    </td>
                    <td><input type="button" class="btn test-log-btn" value='log'/></td>
                    <td><input type="button" class="btn test-start-btn" value='run'/></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    {% include "error_modal.html" %}
    {% include "info_modal.html" %}
    {% include "log_modal.html" %}

    <script src="/static/bootstrap/js/bootstrap-typeahead.js"></script>
    <script src="/static/bootstrap/js/bootstrap-tooltip.js"></script>
    <script src="/static/bootstrap/js/bootstrap-popover.js"></script>

{% endblock %}